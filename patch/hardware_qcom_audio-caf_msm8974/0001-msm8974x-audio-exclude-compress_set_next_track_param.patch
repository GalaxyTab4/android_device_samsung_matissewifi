From d61d45e195316186c2f7d179e0cab320a2cb542c Mon Sep 17 00:00:00 2001
From: sub77 <sub77@ymail.com>
Date: Mon, 1 Feb 2016 11:59:29 +0100
Subject: [PATCH] msm8974x: audio: exclude compress_set_next_track_param if
 unsupported

https://github.com/CyanogenMod/android_external_tinycompress/commit/3c9df82b91a86d58ba11be90d6fb555438a6209e

Change-Id: I3a50892fdcc388ad95ade74d9fabf80623fd24a9
---
 hal/audio_hw.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/hal/audio_hw.c b/hal/audio_hw.c
index fd3edce..f4f9093 100644
--- a/hal/audio_hw.c
+++ b/hal/audio_hw.c
@@ -2113,12 +2113,14 @@ static ssize_t out_write(struct audio_stream_out *stream, const void *buffer,
             ALOGD("copl(%x):send new gapless metadata", (unsigned int)out);
             compress_set_gapless_metadata(out->compr, &out->gapless_mdata);
             out->send_new_metadata = 0;
+#if defined(SNDRV_COMPRESS_SET_NEXT_TRACK_PARAM)
             if (out->send_next_track_params && out->is_compr_metadata_avail) {
                 ALOGD("copl(%p):send next track params in gapless", out);
                 compress_set_next_track_param(out->compr, &(out->compr_config.codec->options));
                 out->send_next_track_params = false;
                 out->is_compr_metadata_avail = false;
             }
+#endif
         }
 
         ret = compress_write(out->compr, buffer, bytes);
-- 
1.9.1

